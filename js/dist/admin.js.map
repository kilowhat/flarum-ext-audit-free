{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@kilowhat/audit/webpack/bootstrap","webpack://@kilowhat/audit/webpack/runtime/compat get default export","webpack://@kilowhat/audit/webpack/runtime/define property getters","webpack://@kilowhat/audit/webpack/runtime/hasOwnProperty shorthand","webpack://@kilowhat/audit/webpack/runtime/make namespace object","webpack://@kilowhat/audit/external root \"flarum.core.compat['admin/app']\"","webpack://@kilowhat/audit/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@kilowhat/audit/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/Model']\"","webpack://@kilowhat/audit/./src/common/models/AuditLog.ts","webpack://@kilowhat/audit/external root \"flarum.core.compat['admin/components/ExtensionPage']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/app']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/Component']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/components/Button']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/components/GroupBadge']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/models/Group']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@kilowhat/audit/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@kilowhat/audit/./src/common/components/AuditItem.ts","webpack://@kilowhat/audit/./src/common/components/AuditBrowser.ts","webpack://@kilowhat/audit/./src/admin/components/AuditPage.ts","webpack://@kilowhat/audit/./src/admin/index.ts","webpack://@kilowhat/audit/./src/admin/addForumRoutes.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Post from 'flarum/common/models/Post';\nimport Tag from 'flarum/tags/common/models/Tag';\n\nexport default class AuditLog extends Model {\n    actorId = Model.attribute<string>('actorId');\n    client = Model.attribute<string>('client');\n    ipAddress = Model.attribute<string | null>('ipAddress');\n    action = Model.attribute<string>('action');\n    payload = Model.attribute<{ [key: string]: any }>('payload');\n    createdAt = Model.attribute('createdAt', Model.transformDate);\n\n    actor = Model.hasOne<User>('actor');\n    discussion = Model.hasOne<Discussion>('discussion');\n    newDiscussion = Model.hasOne<Discussion>('newDiscussion');\n    post = Model.hasOne<Post>('post');\n    tag = Model.hasOne<Tag>('tag');\n    user = Model.hasOne<User>('user');\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/components/ExtensionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/GroupBadge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Group'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","import {ClassComponent, Vnode} from 'mithril';\nimport app from 'flarum/common/app';\nimport Badge from 'flarum/common/components/Badge';\nimport Button from 'flarum/common/components/Button';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport GroupBadge from 'flarum/common/components/GroupBadge';\nimport avatar from 'flarum/common/helpers/avatar';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport icon from 'flarum/common/helpers/icon';\nimport username from 'flarum/common/helpers/username';\nimport Group from 'flarum/common/models/Group';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport AuditLog from '../models/AuditLog';\n\nconst translationPrefix = 'kilowhat-audit.lib.browser.';\n\nfunction formatGroups(groupIds: string[] | null | undefined, emptyIsAdmin = false) {\n    let groupIdsCopy: string[] = groupIds ? JSON.parse(JSON.stringify(groupIds)) : [];\n\n    if (!groupIdsCopy.length) {\n        if (emptyIsAdmin) {\n            groupIdsCopy.push(Group.ADMINISTRATOR_ID);\n        } else {\n            return m('em', app.translator.trans(translationPrefix + 'noValue'));\n        }\n    }\n\n    return groupIdsCopy.map(groupId => {\n        if (groupId + '' === Group.GUEST_ID) {\n            return Badge.component({\n                icon: 'fas fa-globe',\n                label: app.translator.trans(translationPrefix + 'permissionGroup.everyone'),\n            });\n        }\n\n        if (groupId + '' === Group.MEMBER_ID) {\n            return Badge.component({\n                icon: 'fas fa-user',\n                label: app.translator.trans(translationPrefix + 'permissionGroup.members'),\n            });\n        }\n\n        const group = app.store.getById('groups', groupId);\n\n        if (group) {\n            return GroupBadge.component({\n                group,\n            });\n        }\n\n        return Badge.component({\n            icon: 'fas fa-question',\n            label: extractText(app.translator.trans(translationPrefix + 'deletedResource.group', {\n                id: groupId,\n            })),\n        });\n    }).map((vnode, index) => [index > 0 ? ', ' : null, vnode]);\n}\n\nfunction formatTags(tagSlugs: string[] | null | undefined) {\n    let tagSlugsCopy = tagSlugs || [];\n\n    return tagSlugsCopy.map((slug, index) => [index > 0 ? ', ' : null, m('code', slug)]);\n}\n\ninterface AuditItemAttrs {\n    log: AuditLog\n    changeQuery: (q: string) => void\n}\n\nexport default class AuditItem implements ClassComponent<AuditItemAttrs> {\n    showRaw: boolean = false\n\n    view(vnode: Vnode<AuditItemAttrs>) {\n        const {log, changeQuery} = vnode.attrs;\n\n        const actor = log.actor();\n        const payload = log.payload() || {};\n        const discussion = log.discussion();\n        const newDiscussion = log.newDiscussion();\n        const post = log.post();\n        const tag = log.tag();\n        const user = log.user();\n\n        const clientRow = [];\n\n        if (log.ipAddress()) {\n            clientRow.push(m('a', {\n                onclick: () => {\n                    changeQuery('ip:' + log.ipAddress());\n                },\n            }, log.ipAddress()));\n        }\n\n        if (log.client() !== 'session' && log.client() !== 'cli') {\n            clientRow.push(m('a', {\n                onclick: () => {\n                    changeQuery('client:' + log.client());\n                },\n            }, app.translator.trans(translationPrefix + 'client.' + log.client())));\n        }\n\n        clientRow.push(humanTime(log.createdAt()!));\n\n        let avatarElement;\n\n        if (log.client() === 'cli') {\n            avatarElement = icon('fas fa-terminal');\n        } else if (log.actorId() === null) {\n            avatarElement = icon('fas fa-user-secret');\n        } else if (actor) {\n            avatarElement = m('a', {\n                href: actor ? app.route.user(actor) : '#',\n            }, avatar(actor));\n        } else {\n            // In this case actorId isn't null but actor is, which means the user was deleted\n            avatarElement = avatar(null);\n        }\n\n        let usernameElement;\n\n        if (log.client() === 'cli') {\n            usernameElement = m('a', {\n                onclick: () => {\n                    changeQuery('client:cli');\n                },\n            }, app.translator.trans(translationPrefix + 'client.cli'));\n        } else if (log.actorId() === null) {\n            usernameElement = m('a', {\n                onclick: () => {\n                    changeQuery('actor:guest');\n                },\n            }, app.translator.trans(translationPrefix + 'withoutActor'));\n        } else if (actor) {\n            usernameElement = m('a', {\n                onclick: () => {\n                    changeQuery('actor:' + actor.username());\n                },\n            }, username(actor));\n        } else {\n            // In this case actorId isn't null but actor is, which means the user was deleted\n            usernameElement = username(actor);\n        }\n\n        let formattedPayload;\n\n        let translationKeyForPayload = translationPrefix + log.action();\n\n        if (log.action() === 'setting_changed' && payload.hasOwnProperty('new_value')) {\n            translationKeyForPayload = translationPrefix + 'setting_changed_with_values';\n        }\n\n        if (typeof app.translator.translations[translationKeyForPayload] === 'string') {\n            const parameters = {\n                // We can't call this translation parameter {user} because it's reserved by Flarum\n                username: m('a', {\n                    href: user ? app.route.user(user) : '#',\n                }, user ? username(user) : app.translator.trans(translationPrefix + 'deletedResource.user', {\n                    id: payload.user_id,\n                })),\n\n                discussion: m('a', {\n                    href: discussion ? app.route.discussion(discussion) : '#',\n                }, discussion ? discussion.title() : app.translator.trans(translationPrefix + 'deletedResource.discussion', {\n                    id: payload.discussion_id,\n                })),\n\n                new_discussion: m('a', {\n                    href: newDiscussion ? app.route.discussion(newDiscussion) : '#',\n                }, newDiscussion ? newDiscussion.title() : app.translator.trans(translationPrefix + 'deletedResource.discussion', {\n                    id: payload.new_discussion_id,\n                })),\n\n                tag: m('a', {\n                    href: tag ? app.route.tag(tag) : '#',\n                }, tag ? tag.name() : app.translator.trans(translationPrefix + 'deletedResource.tag', {\n                    id: payload.tag_id,\n                })),\n\n                post: m('a', {\n                    href: post && post.discussion() ? app.route.post(post) : '#',\n                }, post ? app.translator.trans(translationPrefix + 'genericResource.' + (post.contentType() === 'comment' ? 'comment' : 'post')) : app.translator.trans(translationPrefix + 'deletedResource.post', {\n                    id: payload.post_id,\n                })),\n\n                postuser: m('a', {\n                    href: post && post.user() ? app.route.user(post.user()) : '#',\n                }, username(post ? post.user() : null)),\n\n                until: payload.until ? dayjs(payload.until).format('LLLL') : '?',\n\n                old_title: m('em', payload.old_title),\n\n                new_title: payload.new_title && discussion ? m('a', {\n                    href: app.route.discussion(discussion),\n                }, payload.new_title) : payload.new_title,\n\n                package: m('code', payload.package),\n                provider: m('code', payload.provider),\n                ip: m('code', payload.ip),\n\n                key: m('code', payload.key),\n                permission: m('code', payload.permission),\n                old_value: payload.old_value ? m('code', payload.old_value) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_value: payload.new_value ? m('code', payload.new_value) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                old_groups: formatGroups(payload.old_group_ids, log.action() === 'permission_changed'),\n                new_groups: formatGroups(payload.new_group_ids, log.action() === 'permission_changed'),\n\n                old_username: m('code', payload.old_username),\n                new_username: m('code', payload.new_username),\n\n                old_nickname: payload.old_nickname ? m('code', payload.old_nickname) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_nickname: payload.new_nickname ? m('code', payload.new_nickname) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                old_email: m('code', payload.old_email),\n                new_email: m('code', payload.new_email),\n\n                old_tags: formatTags(payload.old_tags),\n                new_tags: formatTags(payload.new_tags),\n\n                original_discussion_ids_count: Array.isArray(payload.original_discussion_ids) ? payload.original_discussion_ids.length : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                post_count: payload.post_count,\n\n                old_user: payload.old_user_id ? app.translator.trans(translationPrefix + 'deletedResource.user', {\n                    id: payload.old_user_id,\n                }) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_user: payload.new_user_id ? app.translator.trans(translationPrefix + 'deletedResource.user', {\n                    id: payload.new_user_id,\n                }) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                old_date: payload.old_date ? dayjs(payload.old_date).format('LLLL') : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_date: payload.new_date ? dayjs(payload.new_date).format('LLLL') : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                reason: payload.reason ? m('code', payload.reason) : m('em', app.translator.trans(translationPrefix + 'noReason')),\n\n                deleted_count: payload.deleted_count,\n            };\n\n            formattedPayload = app.translator.trans(translationKeyForPayload, parameters);\n\n            if (this.showRaw) {\n                formattedPayload = [formattedPayload, m('pre', JSON.stringify(payload, null, 2))];\n            }\n        } else {\n            formattedPayload = JSON.stringify(payload);\n        }\n\n        const controls = new ItemList();\n\n        controls.add('raw', Button.component({\n            onclick: () => {\n                this.showRaw = !this.showRaw;\n            },\n        }, app.translator.trans(translationPrefix + 'controls.' + (this.showRaw ? 'hideRaw' : 'showRaw'))));\n\n        if (actor) {\n            controls.add('actor', Button.component({\n                onclick: () => {\n                    changeQuery('actor:' + actor.username());\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterActor')));\n        }\n\n        if (log.ipAddress()) {\n            controls.add('ip', Button.component({\n                onclick: () => {\n                    changeQuery('ip:' + log.ipAddress());\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterIp')));\n        }\n\n        controls.add('client', Button.component({\n            onclick: () => {\n                changeQuery('client:' + log.client());\n            },\n        }, app.translator.trans(translationPrefix + 'controls.filterClient')));\n\n        controls.add('action', Button.component({\n            onclick: () => {\n                changeQuery('action:' + log.action());\n            },\n        }, app.translator.trans(translationPrefix + 'controls.filterAction')));\n\n        if (user) {\n            controls.add('user', Button.component({\n                onclick: () => {\n                    changeQuery('user:' + user.username());\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterUser')));\n        }\n\n        if (payload.discussion_id) {\n            controls.add('discussion', Button.component({\n                onclick: () => {\n                    changeQuery('discussion:' + payload.discussion_id);\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterDiscussion')));\n        }\n\n        return m('.AuditItem', [\n            m('.AuditItemAvatar', avatarElement),\n            m('.AuditItemData', [\n                Dropdown.component({\n                    menuClassName: 'Dropdown-menu--right',\n                    buttonClassName: 'Button Button--icon Button--flat',\n                    label: app.translator.trans(translationPrefix + 'controls'),\n                    icon: 'fas fa-ellipsis-v',\n                }, controls.toArray()),\n                m('.AuditItemRow', [\n                    usernameElement,\n                    ' - ',\n                    m('a', {\n                        onclick: () => {\n                            changeQuery('action:' + log.action());\n                        },\n                    }, log.action()),\n                ]),\n                m('.AuditItemRow', formattedPayload),\n                m('.AuditItemRow', clientRow.map((text, i) => [i === 0 ? null : ' - ', text])),\n            ]),\n        ]);\n    }\n}\n","import app from 'flarum/common/app';\nimport Component, {ComponentAttrs} from 'flarum/common/Component';\nimport {ApiResponsePlural} from 'flarum/common/Store';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Placeholder from 'flarum/common/components/Placeholder';\nimport AuditItem from './AuditItem';\nimport AuditLog from '../models/AuditLog';\n\nconst translationPrefix = 'kilowhat-audit.lib.browser.';\n\ninterface AuditBrowserAttrs extends ComponentAttrs {\n    baseQ?: string\n}\n\nexport default class AuditBrowser extends Component<AuditBrowserAttrs> {\n    q: string = ''\n    loading: boolean = true\n    moreResults: boolean = false\n    logs: AuditLog[] = []\n\n    oninit(vnode: any) {\n        super.oninit(vnode);\n\n        this.refresh();\n    }\n\n    view() {\n        let loading;\n\n        if (this.loading) {\n            loading = LoadingIndicator.component();\n        } else if (this.moreResults) {\n            loading = Button.component({\n                className: 'Button Button--block',\n                onclick: this.loadMore.bind(this),\n            }, app.translator.trans(translationPrefix + 'loadMore'));\n        }\n\n        return m('div', [\n            m('.AuditSearch', [\n                m('.AuditSearchWrapper', [\n                    m('input.FormControl', {\n                        value: this.q,\n                        onchange: (event: InputEvent) => {\n                            this.q = (event.target as HTMLInputElement).value;\n                        },\n                        placeholder: app.translator.trans(translationPrefix + 'filterPlaceholder'),\n                    }),\n                    this.q ? Button.component({\n                        className: 'Search-clear Button Button--icon Button--link',\n                        onclick: () => {\n                            this.q = '';\n                            this.refresh();\n                        },\n                        icon: 'fas fa-times-circle',\n                    }) : null,\n                ]),\n                Button.component({\n                    className: 'Button',\n                    onclick: () => {\n                        this.refresh();\n                    },\n                }, app.translator.trans(translationPrefix + 'filterApply')),\n            ]),\n            this.logs.length === 0 && !this.loading ? Placeholder.component({\n                text: app.translator.trans(translationPrefix + 'empty'),\n            }) : null,\n            m('.AuditList', this.logs.map(log => m(AuditItem, {\n                log,\n                changeQuery: (q: string) => {\n                    this.q = q;\n                    this.refresh();\n                },\n            }))),\n            m('.AuditMore', loading),\n        ]);\n    }\n\n    requestParams(): any {\n        const params: any = {filter: {}};\n\n        let q = this.attrs.baseQ || '';\n\n        if (this.q) {\n            q += ' ' + this.q;\n        }\n\n        if (q) {\n            params.filter.q = q.trim();\n        }\n\n        return params;\n    }\n\n    refresh(clear = true) {\n        if (clear) {\n            this.loading = true;\n            this.logs = [];\n        }\n\n        return this.loadResults().then(\n            results => {\n                this.logs = [];\n                this.parseResults(results);\n            },\n            () => {\n                this.loading = false;\n                m.redraw();\n            }\n        );\n    }\n\n    loadResults(offset: number | undefined = undefined) {\n        const params = this.requestParams();\n        params.page = {offset};\n\n        return app.store.find<AuditLog[]>('kilowhat-audit/logs', params);\n    }\n\n    loadMore() {\n        this.loading = true;\n\n        this.loadResults(this.logs.length)\n            .then(this.parseResults.bind(this));\n    }\n\n    parseResults(results: ApiResponsePlural<AuditLog>) {\n        [].push.apply(this.logs, results as any);\n\n        this.loading = false;\n        this.moreResults = !!results.payload.links?.next;\n\n        m.redraw();\n\n        return results;\n    }\n}\n","import app from 'flarum/admin/app';\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport icon from 'flarum/common/helpers/icon';\nimport AuditBrowser from '../../common/components/AuditBrowser';\n\nconst translationPrefix = 'kilowhat-audit.admin.header.';\n\nexport default class AuditPage extends ExtensionPage {\n    className() {\n        // We need a common class that's identical between free and pro to re-use CSS\n        return super.className() + ' AuditPage';\n    }\n\n    header() {\n        const vdom = super.header();\n\n        if (Array.isArray(vdom) && vdom.length && Array.isArray(vdom[0].children)) {\n            // .ExtensionPage-header\n            vdom[0].children.push(icon('fas fa-book', {\n                className: 'AuditBanner',\n            }));\n\n            try {\n                vdom[0].children[0].children[0].children[1].children = [\n                    m('h2', [\n                        app.translator.trans(translationPrefix + 'title'),\n                        m('span.badge', app.translator.trans(translationPrefix + 'free')),\n                        m('a.AuditUpgrade', {\n                            target: '_blank',\n                            href: 'https://kilowhat.net/flarum/extensions/audit',\n                        }, [\n                            icon('fas fa-rocket'),\n                            ' ',\n                            app.translator.trans(translationPrefix + 'upgrade'),\n                        ]),\n                    ]),\n                ];\n            } catch (e) {\n                console.warn('[audit-log] Unable to add Free badge to header');\n            }\n        } else {\n            console.warn('[audit-log] Unable to change header styling');\n        }\n\n        return vdom;\n    }\n\n    content() {\n        return m('.AuditPageContainer', m(AuditBrowser));\n    }\n}\n","import app from 'flarum/admin/app';\nimport AuditLog from '../common/models/AuditLog';\nimport AuditPage from './components/AuditPage';\nimport addForumRoutes from './addForumRoutes';\n\napp.initializers.add('kilowhat-audit', () => {\n    app.store.models['kilowhat-audit'] = AuditLog;\n\n    addForumRoutes();\n\n    app.extensionData\n        .for('kilowhat-audit-free')\n        .registerPage(AuditPage);\n});\n","import app from 'flarum/admin/app';\n\n// When we are in the admin panel, the URL route builders for the frontend aren't available\n// So we add them if they are missing\nexport default function () {\n    if (!app.route.discussion) {\n        app.route.discussion = discussion => {\n            return app.forum.attribute('baseUrl') + '/d/' + discussion.slug();\n        };\n    }\n    if (!app.route.post) {\n        app.route.post = post => {\n            return app.route.discussion(post.discussion()) + '/' + post.number();\n        };\n    }\n    if (!app.route.tag) {\n        app.route.tag = tag => {\n            return app.forum.attribute('baseUrl') + '/t/' + tag.slug();\n        };\n    }\n    if (!app.route.user) {\n        app.route.user = user => {\n            return app.forum.attribute('baseUrl') + '/u/' + user.slug();\n        };\n    }\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","AuditLog","_Model","_this","_len","arguments","length","args","Array","_key","apply","concat","actorId","Model","client","ipAddress","action","payload","createdAt","actor","discussion","newDiscussion","post","tag","user","translationPrefix","formatGroups","groupIds","emptyIsAdmin","groupIdsCopy","JSON","parse","stringify","m","app","trans","push","Group","map","groupId","Badge","icon","label","group","getById","GroupBadge","extractText","id","vnode","index","formatTags","tagSlugs","slug","AuditItem","showRaw","view","avatarElement","usernameElement","formattedPayload","_vnode$attrs","attrs","log","changeQuery","clientRow","onclick","humanTime","href","avatar","username","translationKeyForPayload","translations","parameters","user_id","title","discussion_id","new_discussion","new_discussion_id","name","tag_id","contentType","post_id","postuser","until","dayjs","format","old_title","new_title","package","provider","ip","permission","old_value","new_value","old_groups","old_group_ids","new_groups","new_group_ids","old_username","new_username","old_nickname","new_nickname","old_email","new_email","old_tags","new_tags","original_discussion_ids_count","isArray","original_discussion_ids","post_count","old_user","old_user_id","new_user","new_user_id","old_date","new_date","reason","deleted_count","this","controls","ItemList","add","Button","Dropdown","menuClassName","buttonClassName","toArray","text","i","AuditBrowser","_Component","q","loading","moreResults","logs","_proto","oninit","refresh","_this2","LoadingIndicator","className","loadMore","onchange","event","target","placeholder","Placeholder","requestParams","params","filter","baseQ","trim","clear","_this3","loadResults","then","results","parseResults","redraw","offset","undefined","page","find","_results$payload$link","links","next","Component","AuditPage","_ExtensionPage","header","vdom","children","e","console","warn","content","ExtensionPage","models","attribute","number","registerPage"],"sourceRoot":""}