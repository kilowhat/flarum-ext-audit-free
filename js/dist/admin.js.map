{"version":3,"sources":["webpack://@kilowhat/audit/webpack/bootstrap","webpack://@kilowhat/audit/external \"flarum.core.compat['app']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['Model']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/Button']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['helpers/icon']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['helpers/username']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/Badge']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['models/Group']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['helpers/avatar']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['utils/mixin']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['extend']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/AdminLinkButton']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/AdminNav']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/Page']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['Component']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/Placeholder']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/Dropdown']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['components/GroupBadge']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['helpers/humanTime']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['utils/extractText']\"","webpack://@kilowhat/audit/external \"flarum.core.compat['utils/ItemList']\"","webpack://@kilowhat/audit/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@kilowhat/audit/./src/common/models/AuditLog.js","webpack://@kilowhat/audit/./src/common/components/AuditItem.js","webpack://@kilowhat/audit/./src/common/components/AuditBrowser.js","webpack://@kilowhat/audit/./src/admin/components/Header.js","webpack://@kilowhat/audit/./src/admin/components/AuditPage.js","webpack://@kilowhat/audit/./src/admin/index.js","webpack://@kilowhat/audit/./src/admin/addForumRoutes.js","webpack://@kilowhat/audit/./src/admin/addPage.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_inheritsLoose","subClass","superClass","constructor","__proto__","AuditLog","mixin","Model","actorId","attribute","client","ipAddress","action","payload","createdAt","transformDate","actor","hasOne","discussion","post","tag","user","translationPrefix","formatGroups","groupIds","emptyIsAdmin","groupIdsCopy","JSON","parse","stringify","length","app","translator","trans","push","Group","ADMINISTRATOR_ID","map","groupId","GUEST_ID","Badge","component","icon","label","MEMBER_ID","group","store","getById","GroupBadge","extractText","id","vnode","index","formatTags","tagSlugs","slug","AuditItem","oninit","this","showRaw","view","avatarElement","usernameElement","formattedPayload","attrs","log","changeQuery","clientRow","onclick","humanTime","href","route","avatar","username","translationKeyForPayload","translations","parameters","user_id","title","discussion_id","tag_id","contentType","post_id","postuser","until","moment","format","old_title","new_title","package","provider","ip","permission","old_value","new_value","old_groups","old_group_ids","new_groups","new_group_ids","old_username","new_username","old_email","new_email","old_tags","new_tags","post_count","old_user","old_user_id","new_user","new_user_id","old_date","new_date","reason","controls","ItemList","add","Button","Dropdown","menuClassName","buttonClassName","toArray","text","AuditBrowser","q","loading","moreResults","logs","refresh","LoadingIndicator","className","loadMore","onchange","event","target","placeholder","Placeholder","requestParams","params","filter","baseQ","trim","clear","loadResults","then","results","parseResults","redraw","offset","page","find","apply","links","next","Component","Header","version","data","extensions","AuditPage","Page","initializers","models","forum","number","routes","path","extensionSettings","set","extend","AdminNav","items","AdminLinkButton","description"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 21);\n","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['components/Badge'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['utils/mixin'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['components/AdminLinkButton'];","module.exports = flarum.core.compat['components/AdminNav'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/Placeholder'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['components/GroupBadge'];","module.exports = flarum.core.compat['helpers/humanTime'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['utils/ItemList'];","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class AuditLog extends mixin(Model, {\n    actorId: Model.attribute('actorId'),\n    client: Model.attribute('client'),\n    ipAddress: Model.attribute('ipAddress'),\n    action: Model.attribute('action'),\n    payload: Model.attribute('payload'),\n    createdAt: Model.attribute('createdAt', Model.transformDate),\n\n    actor: Model.hasOne('actor'),\n    discussion: Model.hasOne('discussion'),\n    post: Model.hasOne('post'),\n    tag: Model.hasOne('tag'),\n    user: Model.hasOne('user'),\n}) {\n    //\n}\n","import app from 'flarum/app';\nimport Badge from 'flarum/components/Badge';\nimport Button from 'flarum/components/Button';\nimport Dropdown from 'flarum/components/Dropdown';\nimport GroupBadge from 'flarum/components/GroupBadge';\nimport avatar from 'flarum/helpers/avatar';\nimport humanTime from 'flarum/helpers/humanTime';\nimport icon from 'flarum/helpers/icon';\nimport username from 'flarum/helpers/username';\nimport Group from 'flarum/models/Group';\nimport extractText from 'flarum/utils/extractText';\nimport ItemList from 'flarum/utils/ItemList';\n\n/* global m, moment */\n\nconst translationPrefix = 'kilowhat-audit.lib.browser.';\n\nfunction formatGroups(groupIds, emptyIsAdmin = false) {\n    let groupIdsCopy = groupIds ? JSON.parse(JSON.stringify(groupIds)) : [];\n\n    if (!groupIdsCopy.length) {\n        if (emptyIsAdmin) {\n            groupIdsCopy.push(Group.ADMINISTRATOR_ID);\n        } else {\n            return m('em', app.translator.trans(translationPrefix + 'noValue'));\n        }\n    }\n\n    return groupIdsCopy.map(groupId => {\n        if (groupId + '' === Group.GUEST_ID) {\n            return Badge.component({\n                icon: 'fas fa-globe',\n                label: app.translator.trans(translationPrefix + 'permissionGroup.everyone'),\n            });\n        }\n\n        if (groupId + '' === Group.MEMBER_ID) {\n            return Badge.component({\n                icon: 'fas fa-user',\n                label: app.translator.trans(translationPrefix + 'permissionGroup.members'),\n            });\n        }\n\n        const group = app.store.getById('groups', groupId);\n\n        if (group) {\n            return GroupBadge.component({\n                group,\n            });\n        }\n\n        return Badge.component({\n            icon: 'fas fa-question',\n            label: extractText(app.translator.trans(translationPrefix + 'deletedResource.group', {\n                id: groupId,\n            })),\n        });\n    }).map((vnode, index) => [index > 0 ? ', ' : null, vnode]);\n}\n\nfunction formatTags(tagSlugs) {\n    let tagSlugsCopy = tagSlugs || [];\n\n    return tagSlugsCopy.map((slug, index) => [index > 0 ? ', ' : null, m('code', slug)]);\n}\n\nexport default class AuditItem {\n    oninit() {\n        this.showRaw = false;\n    }\n\n    view(vnode) {\n        const {log, changeQuery} = vnode.attrs;\n\n        const actor = log.actor();\n        const payload = log.payload() || {};\n        const discussion = log.discussion();\n        const post = log.post();\n        const tag = log.tag();\n        const user = log.user();\n\n        const clientRow = [];\n\n        if (log.ipAddress()) {\n            clientRow.push(m('a', {\n                onclick: () => {\n                    changeQuery('ip:' + log.ipAddress());\n                },\n            }, log.ipAddress()));\n        }\n\n        if (log.client() !== 'session' && log.client() !== 'cli') {\n            clientRow.push(m('a', {\n                onclick: () => {\n                    changeQuery('client:' + log.client());\n                },\n            }, app.translator.trans(translationPrefix + 'client.' + log.client())));\n        }\n\n        clientRow.push(humanTime(log.createdAt()));\n\n        let avatarElement;\n\n        if (log.client() === 'cli') {\n            avatarElement = icon('fas fa-terminal');\n        } else if (log.actorId() === null) {\n            avatarElement = icon('fas fa-user-secret');\n        } else if (actor) {\n            avatarElement = m('a', {\n                href: actor ? app.route.user(actor) : '#',\n            }, avatar(actor));\n        } else {\n            // In this case actorId isn't null but actor is, which means the user was deleted\n            avatarElement = avatar(null);\n        }\n\n        let usernameElement;\n\n        if (log.client() === 'cli') {\n            usernameElement = m('a', {\n                onclick: () => {\n                    changeQuery('client:cli');\n                },\n            }, app.translator.trans(translationPrefix + 'client.cli'));\n        } else if (log.actorId() === null) {\n            usernameElement = m('a', {\n                onclick: () => {\n                    changeQuery('actor:guest');\n                },\n            }, app.translator.trans(translationPrefix + 'withoutActor'));\n        } else if (actor) {\n            usernameElement = m('a', {\n                onclick: () => {\n                    changeQuery('actor:' + actor.username());\n                },\n            }, username(actor));\n        } else {\n            // In this case actorId isn't null but actor is, which means the user was deleted\n            usernameElement = username(actor);\n        }\n\n        let formattedPayload;\n\n        let translationKeyForPayload = translationPrefix + log.action();\n\n        if (log.action() === 'setting_changed' && payload.hasOwnProperty('new_value')) {\n            translationKeyForPayload = translationPrefix + 'setting_changed_with_values';\n        }\n\n        if (typeof app.translator.translations[translationKeyForPayload] === 'string') {\n            const parameters = {\n                // We can't call this translation parameter {user} because it's reserved by Flarum\n                username: m('a', {\n                    href: user ? app.route.user(user) : '#',\n                }, user ? username(user) : app.translator.trans(translationPrefix + 'deletedResource.user', {\n                    id: payload.user_id,\n                })),\n\n                discussion: m('a', {\n                    href: discussion ? app.route.discussion(discussion) : '#',\n                }, discussion ? discussion.title() : app.translator.trans(translationPrefix + 'deletedResource.discussion', {\n                    id: payload.discussion_id,\n                })),\n\n                tag: m('a', {\n                    href: tag ? app.route.tag(tag) : '#',\n                }, tag ? tag.name() : app.translator.trans(translationPrefix + 'deletedResource.tag', {\n                    id: payload.tag_id,\n                })),\n\n                post: m('a', {\n                    href: post && post.discussion() ? app.route.post(post) : '#',\n                }, post ? app.translator.trans(translationPrefix + 'genericResource.' + (post.contentType() === 'comment' ? 'comment' : 'post')) : app.translator.trans(translationPrefix + 'deletedResource.post', {\n                    id: payload.post_id,\n                })),\n\n                postuser: m('a', {\n                    href: post && post.user() ? app.route.user(post.user()) : '#',\n                }, username(post ? post.user() : null)),\n\n                until: payload.until ? moment(payload.until).format('LLLL') : '?',\n\n                old_title: m('em', payload.old_title),\n\n                new_title: payload.new_title && discussion ? m('a', {\n                    href: app.route.discussion(discussion),\n                }, payload.new_title) : payload.new_title,\n\n                package: m('code', payload.package),\n                provider: m('code', payload.provider),\n                ip: m('code', payload.ip),\n\n                key: m('code', payload.key),\n                permission: m('code', payload.permission),\n                old_value: payload.old_value ? m('code', payload.old_value) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_value: payload.new_value ? m('code', payload.new_value) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                old_groups: formatGroups(payload.old_group_ids, log.action() === 'permission_changed'),\n                new_groups: formatGroups(payload.new_group_ids, log.action() === 'permission_changed'),\n\n                old_username: m('code', payload.old_username),\n                new_username: m('code', payload.new_username),\n\n                old_email: m('code', payload.old_email),\n                new_email: m('code', payload.new_email),\n\n                old_tags: formatTags(payload.old_tags),\n                new_tags: formatTags(payload.new_tags),\n\n                post_count: payload.post_count,\n\n                old_user: payload.old_user_id ? app.translator.trans(translationPrefix + 'deletedResource.user', {\n                    id: payload.old_user_id,\n                }) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_user: payload.new_user_id ? app.translator.trans(translationPrefix + 'deletedResource.user', {\n                    id: payload.new_user_id,\n                }) : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                old_date: payload.old_date ? moment(payload.old_date).format('LLLL') : m('em', app.translator.trans(translationPrefix + 'noValue')),\n                new_date: payload.new_date ? moment(payload.new_date).format('LLLL') : m('em', app.translator.trans(translationPrefix + 'noValue')),\n\n                reason: payload.reason ? m('code', payload.reason) : m('em', app.translator.trans(translationPrefix + 'noReason')),\n            };\n\n            formattedPayload = app.translator.trans(translationKeyForPayload, parameters);\n\n            if (this.showRaw) {\n                formattedPayload = [formattedPayload, m('pre', JSON.stringify(payload, null, 2))];\n            }\n        } else {\n            formattedPayload = JSON.stringify(payload);\n        }\n\n        const controls = new ItemList();\n\n        controls.add('raw', Button.component({\n            onclick: () => {\n                this.showRaw = !this.showRaw;\n            },\n        }, app.translator.trans(translationPrefix + 'controls.' + (this.showRaw ? 'hideRaw' : 'showRaw'))));\n\n        if (actor) {\n            controls.add('actor', Button.component({\n                onclick: () => {\n                    changeQuery('actor:' + actor.username());\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterActor')));\n        }\n\n        if (log.ipAddress()) {\n            controls.add('ip', Button.component({\n                onclick: () => {\n                    changeQuery('ip:' + log.ipAddress());\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterIp')));\n        }\n\n        controls.add('client', Button.component({\n            onclick: () => {\n                changeQuery('client:' + log.client());\n            },\n        }, app.translator.trans(translationPrefix + 'controls.filterClient')));\n\n        controls.add('action', Button.component({\n            onclick: () => {\n                changeQuery('action:' + log.action());\n            },\n        }, app.translator.trans(translationPrefix + 'controls.filterAction')));\n\n        if (user) {\n            controls.add('user', Button.component({\n                onclick: () => {\n                    changeQuery('user:' + user.username());\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterUser')));\n        }\n\n        if (payload.discussion_id) {\n            controls.add('discussion', Button.component({\n                onclick: () => {\n                    changeQuery('discussion:' + payload.discussion_id);\n                },\n            }, app.translator.trans(translationPrefix + 'controls.filterDiscussion')));\n        }\n\n        return m('.AuditItem', [\n            m('.AuditItemAvatar', avatarElement),\n            m('.AuditItemData', [\n                Dropdown.component({\n                    menuClassName: 'Dropdown-menu--right',\n                    buttonClassName: 'Button Button--icon Button--flat',\n                    label: app.translator.trans(translationPrefix + 'controls'),\n                    icon: 'fas fa-ellipsis-v',\n                }, controls.toArray()),\n                m('.AuditItemRow', [\n                    usernameElement,\n                    ' - ',\n                    m('a', {\n                        onclick: () => {\n                            changeQuery('action:' + log.action());\n                        },\n                    }, log.action()),\n                ]),\n                m('.AuditItemRow', formattedPayload),\n                m('.AuditItemRow', clientRow.map((text, i) => [i === 0 ? null : ' - ', text])),\n            ]),\n        ]);\n    }\n}\n","import app from 'flarum/app';\nimport Component from 'flarum/Component';\nimport Button from 'flarum/components/Button';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\nimport Placeholder from 'flarum/components/Placeholder';\nimport AuditItem from './AuditItem';\n\n/* global m */\n\nconst translationPrefix = 'kilowhat-audit.lib.browser.';\n\nexport default class AuditBrowser extends Component {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.q = '';\n        this.loading = true;\n        this.moreResults = false;\n        this.logs = [];\n\n        this.refresh();\n    }\n\n    view() {\n        let loading;\n\n        if (this.loading) {\n            loading = LoadingIndicator.component();\n        } else if (this.moreResults) {\n            loading = Button.component({\n                className: 'Button Button--block',\n                onclick: this.loadMore.bind(this),\n            }, app.translator.trans(translationPrefix + 'loadMore'));\n        }\n\n        return m('div', [\n            m('.AuditSearch', [\n                m('.AuditSearchWrapper', [\n                    m('input.FormControl', {\n                        value: this.q,\n                        onchange: event => {\n                            this.q = event.target.value;\n                        },\n                        placeholder: app.translator.trans(translationPrefix + 'filterPlaceholder'),\n                    }),\n                    this.q ? Button.component({\n                        className: 'Search-clear Button Button--icon Button--link',\n                        onclick: () => {\n                            this.q = '';\n                            this.refresh();\n                        },\n                        icon: 'fas fa-times-circle',\n                    }) : null,\n                ]),\n                Button.component({\n                    className: 'Button',\n                    onclick: () => {\n                        this.refresh();\n                    },\n                }, app.translator.trans(translationPrefix + 'filterApply')),\n            ]),\n            this.logs.length === 0 && !this.loading ? Placeholder.component({\n                text: app.translator.trans(translationPrefix + 'empty'),\n            }) : null,\n            m('.AuditList', this.logs.map(log => m(AuditItem, {\n                log,\n                changeQuery: q => {\n                    this.q = q;\n                    this.refresh();\n                },\n            }))),\n            m('.AuditMore', loading),\n        ]);\n    }\n\n    requestParams() {\n        const params = {filter: {}};\n\n        let q = this.attrs.baseQ || '';\n\n        if (this.q) {\n            q += ' ' + this.q;\n        }\n\n        if (q) {\n            params.filter.q = q.trim();\n        }\n\n        return params;\n    }\n\n    refresh(clear = true) {\n        if (clear) {\n            this.loading = true;\n            this.logs = [];\n        }\n\n        return this.loadResults().then(\n            results => {\n                this.logs = [];\n                this.parseResults(results);\n            },\n            () => {\n                this.loading = false;\n                m.redraw();\n            }\n        );\n    }\n\n    loadResults(offset) {\n        const params = this.requestParams();\n        params.page = {offset};\n\n        return app.store.find('kilowhat-audit/logs', params);\n    }\n\n    loadMore() {\n        this.loading = true;\n\n        this.loadResults(this.logs.length)\n            .then(this.parseResults.bind(this));\n    }\n\n    parseResults(results) {\n        [].push.apply(this.logs, results);\n\n        this.loading = false;\n        this.moreResults = !!results.payload.links.next;\n\n        m.redraw();\n\n        return results;\n    }\n}\n","import app from 'flarum/app';\nimport icon from 'flarum/helpers/icon';\n\n/* global m */\n\nconst translationPrefix = 'kilowhat-audit.admin.header.';\n\nexport default class Header {\n    view() {\n        return m('.AuditHeader', [\n            icon('fas fa-book', {\n                className: 'AuditBanner',\n            }),\n            m('h1', [\n                app.translator.trans(translationPrefix + 'title'),\n                m('span.badge', app.translator.trans(translationPrefix + 'free')),\n                m('a.AuditUpgrade', {\n                    target: '_blank',\n                    href: 'https://kilowhat.net/flarum/extensions/audit',\n                }, [\n                    icon('fas fa-rocket'),\n                    ' ',\n                    app.translator.trans(translationPrefix + 'upgrade'),\n                ]),\n            ]),\n            m('ul', [\n                m('li', m('a', {\n                    target: '_blank',\n                    href: 'https://kilowhat.net/flarum/extensions/audit',\n                }, [\n                    app.translator.trans(translationPrefix + 'documentation'),\n                    ' ',\n                    icon('fas fa-external-link-alt'),\n                ])),\n                m('li', m('a', {\n                    target: '_blank',\n                    href: 'https://discuss.flarum.org/d/24432',\n                }, [\n                    app.translator.trans(translationPrefix + 'discuss'),\n                    ' ',\n                    icon('fas fa-external-link-alt'),\n                ])),\n                m('li', app.translator.trans(translationPrefix + 'version', {\n                    version: app.data.extensions['kilowhat-audit-free'].version,\n                })),\n            ]),\n        ]);\n    }\n}\n","import Page from 'flarum/components/Page';\nimport AuditBrowser from '../../common/components/AuditBrowser';\nimport Header from './Header';\n\n/* global m */\n\nexport default class AuditPage extends Page {\n    view() {\n        return m('.AuditPage', m('.AuditPageContainer', [\n            m(Header),\n            m(AuditBrowser),\n        ]));\n    }\n}\n","import app from 'flarum/app';\nimport AuditLog from '../common/models/AuditLog';\nimport addForumRoutes from './addForumRoutes';\nimport addPage from './addPage';\n\napp.initializers.add('kilowhat-audit', () => {\n    app.store.models['kilowhat-audit'] = AuditLog;\n\n    addForumRoutes();\n    addPage();\n});\n","import app from 'flarum/app';\n\n// When we are in the admin panel, the URL route builders for the frontend aren't available\n// So we add them if they are missing\nexport default function () {\n    if (!app.route.discussion) {\n        app.route.discussion = discussion => {\n            return app.forum.attribute('baseUrl') + '/d/' + discussion.id();\n        };\n    }\n    if (!app.route.post) {\n        app.route.post = post => {\n            return app.route.discussion(post.discussion()) + '/' + post.number();\n        };\n    }\n    if (!app.route.tag) {\n        app.route.tag = tag => {\n            return app.forum.attribute('baseUrl') + '/t/' + tag.slug();\n        };\n    }\n    if (!app.route.user) {\n        app.route.user = user => {\n            return app.forum.attribute('baseUrl') + '/u/' + user.username();\n        };\n    }\n}\n","import {extend} from 'flarum/extend';\nimport app from 'flarum/app';\nimport AdminLinkButton from 'flarum/components/AdminLinkButton';\nimport AdminNav from 'flarum/components/AdminNav';\nimport AuditPage from './components/AuditPage';\n\n/* global m */\n\nexport default function () {\n    app.routes['kilowhat-audit'] = {\n        path: '/audit',\n        component: AuditPage,\n    };\n\n    app.extensionSettings['kilowhat-audit-free'] = () => m.route.set(app.route('kilowhat-audit'));\n\n    extend(AdminNav.prototype, 'items', items => {\n        items.add('kilowhat-audit', AdminLinkButton.component({\n            href: app.route('kilowhat-audit'),\n            icon: 'fas fa-book',\n            description: app.translator.trans('kilowhat-audit.admin.menu.description'),\n        }, app.translator.trans('kilowhat-audit.admin.menu.title')));\n    });\n}\n"],"sourceRoot":""}